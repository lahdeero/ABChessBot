<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Piirtoalusta.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ABChessbot</a> &gt; <a href="index.source.html" class="el_package">shakkibeli.kayttoliittyma</a> &gt; <span class="el_source">Piirtoalusta.java</span></div><h1>Piirtoalusta.java</h1><pre class="source lang-java linenums">package shakkibeli.kayttoliittyma;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Stroke;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.concurrent.TimeUnit;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JPanel;
import shakkibeli.logiikka.Pelilogiikka;
import static shakkibeli.nappula.Arvo.*;
import shakkibeli.nappula.Nappula;
import static shakkibeli.nappula.Vari.*;

public class Piirtoalusta extends JPanel {

    private Pelilogiikka logiikka;
    private int ruudunSivunPituus;
    private ImageIcon image;
    private Font font;
    private int odota;

    private ImageIcon mustaSotilas;
    private ImageIcon valkoinenSotilas;
    private ImageIcon mustaTorni;
    private ImageIcon valkoinenTorni;
    private ImageIcon mustaHevonen;
    private ImageIcon valkoinenHevonen;
    private ImageIcon mustaLahetti;
    private ImageIcon valkoinenLahetti;
    private ImageIcon mustaKuningatar;
    private ImageIcon valkoinenKuningatar;
    private ImageIcon mustaKuningas;
    private ImageIcon valkoinenKuningas;

<span class="nc" id="L44">    public Piirtoalusta(Pelilogiikka logiikka, int ruudunSivunPituus) throws IOException {</span>

<span class="nc" id="L46">        this.logiikka = logiikka;</span>
<span class="nc" id="L47">        this.ruudunSivunPituus = ruudunSivunPituus;</span>
<span class="nc" id="L48">        this.font = new Font(&quot;TimesRoman&quot;, Font.PLAIN, ruudunSivunPituus / 4);</span>
<span class="nc" id="L49">        this.odota = 10;</span>
        
<span class="nc" id="L51">        String alihakemisto = &quot;/kuvat/&quot;;</span>
<span class="nc" id="L52">        mustaSotilas = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;mustaSotilas.png&quot;));</span>
<span class="nc" id="L53">        valkoinenSotilas = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;valkoinenSotilas.png&quot;));</span>
<span class="nc" id="L54">        mustaTorni = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;mustaTorni.png&quot;));</span>
<span class="nc" id="L55">        valkoinenTorni = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;valkoinenTorni.png&quot;));</span>
<span class="nc" id="L56">        mustaHevonen = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;mustaHevonen.png&quot;));</span>
<span class="nc" id="L57">        valkoinenHevonen = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;valkoinenHevonen.png&quot;));</span>
<span class="nc" id="L58">        mustaLahetti = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;mustaLahetti.png&quot;));</span>
<span class="nc" id="L59">        valkoinenLahetti = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;valkoinenLahetti.png&quot;));</span>
<span class="nc" id="L60">        mustaKuningatar = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;mustaKuningatar.png&quot;));</span>
<span class="nc" id="L61">        valkoinenKuningatar = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;valkoinenKuningatar.png&quot;));</span>
<span class="nc" id="L62">        mustaKuningas = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;mustaKuningas.png&quot;));</span>
<span class="nc" id="L63">        valkoinenKuningas = new ImageIcon(this.getClass().getResource(alihakemisto + &quot;valkoinenKuningas.png&quot;));</span>
<span class="nc" id="L64">    }</span>

    @Override
    protected void paintComponent(Graphics g) {
<span class="nc" id="L68">        super.paintComponent(g);</span>
<span class="nc" id="L69">        g.setFont(font);</span>
<span class="nc" id="L70">        piirraLauta(g);</span>
        try {
<span class="nc" id="L72">            piirraNapit(g);</span>
<span class="nc" id="L73">        } catch (IOException ex) {</span>
<span class="nc" id="L74">            Logger.getLogger(Piirtoalusta.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L75">        }</span>
<span class="nc" id="L76">        paivita();</span>

<span class="nc" id="L78">    }</span>

    public void piirraLauta(Graphics g) {
<span class="nc" id="L81">        int edellinenX = -1;</span>
<span class="nc" id="L82">        int edellinenY = -1;</span>
<span class="nc" id="L83">        int uusiSiirtoX = -1;</span>
<span class="nc" id="L84">        int uusiSiirtoY = -1;</span>
<span class="nc" id="L85">        boolean valkoinen = true;</span>
        
<span class="nc bnc" id="L87" title="All 2 branches missed.">        if (logiikka.getLauta().getHistoria().getHistoriaKoko() &gt; 0) {</span>
<span class="nc" id="L88">            edellinenX = logiikka.getLauta().getHistoria().getViimeinenSiirto().getX();</span>
<span class="nc" id="L89">            edellinenY = logiikka.getLauta().getHistoria().getViimeinenSiirto().getY();</span>
<span class="nc" id="L90">            uusiSiirtoX = logiikka.getLauta().getHistoria().getViimeinenSiirto().getUusiX();</span>
<span class="nc" id="L91">            uusiSiirtoY = logiikka.getLauta().getHistoria().getViimeinenSiirto().getUusiY();</span>
        }
        
<span class="nc bnc" id="L94" title="All 2 branches missed.">        for (int y = 0; y &lt; 8; y++) {</span>
<span class="nc bnc" id="L95" title="All 2 branches missed.">            for (int x = 0; x &lt; 8; x++) {</span>
<span class="nc bnc" id="L96" title="All 4 branches missed.">                if (x == edellinenX &amp;&amp; y == edellinenY) {</span>
<span class="nc" id="L97">                    piirraEdellisenSiirronRuutu(x, y, g);</span>
<span class="nc bnc" id="L98" title="All 4 branches missed.">                } else if (x == uusiSiirtoX &amp;&amp; y == uusiSiirtoY) {</span>
<span class="nc" id="L99">                    piirraUudenSiirronRuutu(x, y, g);</span>
<span class="nc bnc" id="L100" title="All 8 branches missed.">                } else if (x % 2 == 1 &amp;&amp; y % 2 == 0 || x % 2 == 0 &amp;&amp; y % 2 == 1) {</span>
<span class="nc" id="L101">                    g.setColor(Color.decode(&quot;#CC6600&quot;));</span>
<span class="nc" id="L102">                    valkoinen = true;</span>
                } else {
<span class="nc" id="L104">                    g.setColor(Color.decode(&quot;#FFCC99&quot;));</span>
<span class="nc" id="L105">                    valkoinen = false;</span>
                }
<span class="nc" id="L107">                g.fillRect(x * ruudunSivunPituus, y * ruudunSivunPituus, ruudunSivunPituus, ruudunSivunPituus);</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">                if (valkoinen) {</span>
<span class="nc" id="L109">                    g.setColor(Color.decode(&quot;#FFCC99&quot;));</span>
                } else {
<span class="nc" id="L111">                    g.setColor(Color.decode(&quot;#CC6600&quot;));</span>
                }
<span class="nc bnc" id="L113" title="All 2 branches missed.">                if (y == 7) {</span>
<span class="nc" id="L114">                    int a = 65 + x;</span>
<span class="nc" id="L115">                    char c = (char) a;</span>
<span class="nc" id="L116">                    String s = &quot;&quot;;</span>
<span class="nc" id="L117">                    s += c;</span>
<span class="nc" id="L118">                    g.drawString(s, x * ruudunSivunPituus + (ruudunSivunPituus / 10 * 8), y * ruudunSivunPituus + (ruudunSivunPituus / 10 * 9));</span>
                }
<span class="nc bnc" id="L120" title="All 2 branches missed.">                if (x == 0) {</span>
<span class="nc" id="L121">                    String s = Integer.toString(8 - y);</span>
<span class="nc" id="L122">                    g.drawString(s, x * ruudunSivunPituus, y * ruudunSivunPituus + (ruudunSivunPituus / 4));</span>
                }
            }
        }
        
<span class="nc bnc" id="L127" title="All 2 branches missed.">        if (logiikka.getJatkuu() == 2) {</span>
<span class="nc" id="L128">            piirraTeksti(g, &quot;shakkimatti!&quot;);</span>
<span class="nc bnc" id="L129" title="All 2 branches missed.">        } else if (logiikka.getJatkuu() == 3) {</span>
<span class="nc" id="L130">            piirraTeksti(g, &quot;tasapeli!&quot;);</span>
<span class="nc bnc" id="L131" title="All 4 branches missed.">        } else if (logiikka.getPelaajia() == 0 &amp;&amp; odota &lt;= 0) {</span>
<span class="nc" id="L132">            odota = 100;</span>
<span class="nc" id="L133">            logiikka.suoritaTekoaly();</span>
<span class="nc bnc" id="L134" title="All 4 branches missed.">        } else if (logiikka.getPelaajia() == 0 &amp;&amp; !logiikka.odotaTekoalya()) {</span>
<span class="nc" id="L135">            odota--;</span>
        }
<span class="nc" id="L137">    }</span>

    public void piirraNapit(Graphics g) throws IOException {

<span class="nc" id="L141">        List&lt;Nappula&gt; nappulat = logiikka.getNappulaLista();</span>

<span class="nc bnc" id="L143" title="All 2 branches missed.">        for (Nappula nappula : nappulat) {</span>
<span class="nc" id="L144">            image = palautaNappulanKuvatiedosto(nappula);</span>
<span class="nc" id="L145">            int x = nappula.getX();</span>
<span class="nc" id="L146">            int y = nappula.getY();</span>
<span class="nc" id="L147">            g.drawImage(image.getImage(), x * ruudunSivunPituus, y * ruudunSivunPituus, ruudunSivunPituus, ruudunSivunPituus, this);</span>

<span class="nc bnc" id="L149" title="All 2 branches missed.">            if (nappula.onkoValittu() == true) {</span>
<span class="nc" id="L150">                piirraPunainenNelio(x, y, g);</span>
            }

<span class="nc" id="L153">        }</span>

<span class="nc" id="L155">        paivita();</span>
<span class="nc" id="L156">    }</span>
    public void piirraTeksti(Graphics g, String teksti) {
<span class="nc" id="L158">        g.setColor(Color.blue);</span>
<span class="nc" id="L159">        g.setFont(new Font(null,Font.BOLD,ruudunSivunPituus));</span>
<span class="nc" id="L160">        g.drawString(teksti, ruudunSivunPituus/2, 4*ruudunSivunPituus);</span>
<span class="nc" id="L161">        g.setFont(font);</span>
<span class="nc" id="L162">    }</span>
    public void piirraPunainenNelio(int x, int y, Graphics g) {
<span class="nc" id="L164">        Graphics2D g2 = (Graphics2D) g;</span>
<span class="nc" id="L165">        double thickness = 10.0;</span>
<span class="nc" id="L166">        Stroke oldStroke = g2.getStroke();</span>
<span class="nc" id="L167">        g2.setStroke(new BasicStroke((float) thickness));</span>
<span class="nc" id="L168">        g2.setColor(Color.red);</span>
<span class="nc" id="L169">        g2.drawRect(x * ruudunSivunPituus, y * ruudunSivunPituus, ruudunSivunPituus, ruudunSivunPituus);</span>
<span class="nc" id="L170">        g2.setStroke(oldStroke);</span>
<span class="nc" id="L171">    }</span>

    public void piirraEdellisenSiirronRuutu(int x, int y, Graphics g) {
<span class="nc" id="L174">        Graphics2D g2 = (Graphics2D) g;</span>
<span class="nc" id="L175">        double thickness = 10.0;</span>
<span class="nc" id="L176">        Stroke oldStroke = g2.getStroke();</span>
<span class="nc" id="L177">        g2.setStroke(new BasicStroke((float) thickness));</span>
<span class="nc" id="L178">        g2.setColor(Color.yellow);</span>
<span class="nc" id="L179">        g2.fillRect(x * ruudunSivunPituus, y * ruudunSivunPituus, ruudunSivunPituus, ruudunSivunPituus);</span>
<span class="nc" id="L180">        g2.setStroke(oldStroke);</span>
<span class="nc" id="L181">    }</span>

    public void piirraUudenSiirronRuutu(int x, int y, Graphics g) {
<span class="nc" id="L184">        Graphics2D g2 = (Graphics2D) g;</span>
<span class="nc" id="L185">        double thickness = 10.0;</span>
<span class="nc" id="L186">        Stroke oldStroke = g2.getStroke();</span>
<span class="nc" id="L187">        g2.setStroke(new BasicStroke((float) thickness));</span>
<span class="nc" id="L188">        g2.setColor(Color.orange);</span>
<span class="nc" id="L189">        g2.fillRect(x * ruudunSivunPituus, y * ruudunSivunPituus, ruudunSivunPituus, ruudunSivunPituus);</span>
<span class="nc" id="L190">        g2.setStroke(oldStroke);</span>
<span class="nc" id="L191">    }</span>

    public ImageIcon palautaNappulanKuvatiedosto(Nappula nappi) {
<span class="nc bnc" id="L194" title="All 4 branches missed.">        if (nappi.getVari() == MUSTA &amp;&amp; nappi.getArvo() == SOTILAS) {</span>
<span class="nc" id="L195">            return mustaSotilas;</span>
<span class="nc bnc" id="L196" title="All 4 branches missed.">        } else if (nappi.getVari() == VALKOINEN &amp;&amp; nappi.getArvo() == SOTILAS) {</span>
<span class="nc" id="L197">            return valkoinenSotilas;</span>
<span class="nc bnc" id="L198" title="All 4 branches missed.">        } else if (nappi.getVari() == MUSTA &amp;&amp; nappi.getArvo() == TORNI) {</span>
<span class="nc" id="L199">            return mustaTorni;</span>
<span class="nc bnc" id="L200" title="All 4 branches missed.">        } else if (nappi.getVari() == VALKOINEN &amp;&amp; nappi.getArvo() == TORNI) {</span>
<span class="nc" id="L201">            return valkoinenTorni;</span>
<span class="nc bnc" id="L202" title="All 4 branches missed.">        } else if (nappi.getVari() == MUSTA &amp;&amp; nappi.getArvo() == HEVONEN) {</span>
<span class="nc" id="L203">            return mustaHevonen;</span>
<span class="nc bnc" id="L204" title="All 4 branches missed.">        } else if (nappi.getVari() == VALKOINEN &amp;&amp; nappi.getArvo() == HEVONEN) {</span>
<span class="nc" id="L205">            return valkoinenHevonen;</span>
<span class="nc bnc" id="L206" title="All 4 branches missed.">        } else if (nappi.getVari() == MUSTA &amp;&amp; nappi.getArvo() == LAHETTI) {</span>
<span class="nc" id="L207">            return mustaLahetti;</span>
<span class="nc bnc" id="L208" title="All 4 branches missed.">        } else if (nappi.getVari() == VALKOINEN &amp;&amp; nappi.getArvo() == LAHETTI) {</span>
<span class="nc" id="L209">            return valkoinenLahetti;</span>
<span class="nc bnc" id="L210" title="All 4 branches missed.">        } else if (nappi.getVari() == MUSTA &amp;&amp; nappi.getArvo() == KUNINGATAR) {</span>
<span class="nc" id="L211">            return mustaKuningatar;</span>
<span class="nc bnc" id="L212" title="All 4 branches missed.">        } else if (nappi.getVari() == VALKOINEN &amp;&amp; nappi.getArvo() == KUNINGATAR) {</span>
<span class="nc" id="L213">            return valkoinenKuningatar;</span>
<span class="nc bnc" id="L214" title="All 4 branches missed.">        } else if (nappi.getVari() == MUSTA &amp;&amp; nappi.getArvo() == KUNINGAS) {</span>
<span class="nc" id="L215">            return mustaKuningas;</span>
<span class="nc bnc" id="L216" title="All 4 branches missed.">        } else if (nappi.getVari() == VALKOINEN &amp;&amp; nappi.getArvo() == KUNINGAS) {</span>
<span class="nc" id="L217">            return valkoinenKuningas;</span>
        }
<span class="nc" id="L219">        return valkoinenSotilas;</span>
    }

    public void paivita() {
<span class="nc" id="L223">        super.repaint();</span>
<span class="nc" id="L224">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>